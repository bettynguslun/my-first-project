<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Hotel Management System</title>
  <style>
    :root {
      --primary: #2d2d8a;
      --success: #27ae60;
      --danger: #e74c3c;
      --warning: #f39c12;
      --light: #ecf0f1;
      --dark: #2c3e50;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', sans-serif; }
    body { background:#f4f6f9; color:#333; }
    header {
      background:var(--primary);
      color:white;
      padding:1rem;
      text-align:center;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }
    nav {
      background:#fff;
      padding:1rem;
      box-shadow:0 2px 5px rgba(0,0,0,0.1);
      position:sticky;
      top:0;
      z-index:100;
    }
    nav ul {
      list-style:none;
      display:flex;
      justify-content:center;
      flex-wrap:wrap;
      gap:1rem;
    }
    nav a {
      color:var(--primary);
      text-decoration:none;
      padding:0.5rem 1rem;
      border-radius:5px;
      transition:0.3s;
    }
    nav a:hover, nav a.active {
      background:var(--primary);
      color:white;
    }
    .container {
      max-width:1200px;
      margin:2rem auto;
      padding:0 1rem;
    }
    .grid {
      display:grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap:1.5rem;
      margin:2rem 0;
    }
    .card {
      background:white;
      padding:1.5rem;
      border-radius:8px;
      box-shadow:0 2px 10px rgba(0,0,0,0.1);
    }
    .card h3 { margin-bottom:1rem; color:var(--primary); }
    .btn {
      padding:0.6rem 1.2rem;
      border:none;
      border-radius:5px;
      cursor:pointer;
      font-weight:bold;
      transition:0.3s;
    }
    .btn-primary { background:var(--primary); color:white; }
    .btn-success { background:var(--success); color:white; }
    .btn-danger { background:var(--danger); color:white; }
    .btn-warning { background:var(--warning); color:white; }
    .btn:hover { opacity:0.9; transform:translateY(-2px); }
    table {
      width:100%;
      border-collapse:collapse;
      margin:1rem 0;
    }
    th, td {
      padding:0.8rem;
      text-align:left;
      border-bottom:1px solid #ddd;
    }
    th { background:#f8f9fa; }
    tr:hover { background:#f5f5f5; }
    .status {
      padding:0.3rem 0.8rem;
      border-radius:20px;
      font-size:0.8rem;
      font-weight:bold;
    }
    .status-available { background:#d5f5e3; color:#27ae60; }
    .status-occupied { background:#fadbd8; color:#e74c3c; }
    .status-cleaning { background:#fef9e1; color:#f39c12; }
    .form-group {
      margin-bottom:1rem;
    }
    label {
      display:block;
      margin-bottom:0.5rem;
      font-weight:600;
    }
    input, select, textarea {
      width:100%;
      padding:0.6rem;
      border:1px solid #ddd;
      border-radius:5px;
      font-size:1rem;
    }
    .hidden { display:none; }
    .modal {
      position:fixed;
      top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.5);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:1000;
    }
    .modal-content {
      background:white;
      padding:2rem;
      border-radius:8px;
      width:90%;
      max-width:500px;
    }
    @media (max-width: 768px) {
      .grid { grid-template-columns:1fr; }
      nav ul { flex-direction:column; }
    }
  </style>
</head>
<body>

<header>
  <h1>üè® Grand Palace Hotel - Management System</h1>
</header>

<nav>
  <ul>
    <li><a href="#" class="active" data-page="dashboard">Dashboard</a></li>
    <li><a href="#" data-page="rooms">Rooms</a></li>
    <li><a href="#" data-page="bookings">Bookings</a></li>
    <li><a href="#" data-page="guests">Guests</a></li>
  </ul>
</nav>

<div class="container">

  <!-- Dashboard -->
  <div id="dashboard">
    <h2>Dashboard</h2>
    <div class="grid">
      <div class="card">
        <h3>Total Rooms</h3>
        <h1 id="totalRooms">0</h1>
      </div>
      <div class="card">
        <h3>Available</h3>
        <h1 id="availableRooms" style="color:var(--success)">0</h1>
      </div>
      <div class="card">
        <h3>Occupied</h3>
        <h1 id="occupiedRooms" style="color:var(--danger)">0</h1>
      </div>
      <div class="card">
        <h3>Today's Bookings</h3>
        <h1 id="todayBookings">0</h1>
      </div>
    </div>
  </div>

  <!-- Rooms -->
  <div id="rooms" class="hidden">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
      <h2>Room Management</h2>
      <button class="btn btn-primary" onclick="openModal('roomModal')">+ Add Room</button>
    </div>
    <div class="card">
      <table id="roomsTable">
        <thead>
          <tr>
            <th>Room No</th>
            <th>Type</th>
            <th>Price/Night</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Bookings -->
  <div id="bookings" class="hidden">
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1rem;">
      <h2>Bookings</h2>
      <button class="btn btn-success" onclick="openModal('bookingModal')">+ New Booking</button>
    </div>
    <input type="text" id="searchBooking" placeholder="Search by guest name or room..." style="margin-bottom:1rem;" onkeyup="filterBookings()">
    <div class="card">
      <table id="bookingsTable">
        <thead>
          <tr>
            <th>ID</th>
            <th>Guest</th>
            <th>Room</th>
            <th>Check In</th>
            <th>Check Out</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <!-- Guests -->
  <div id="guests" class="hidden">
    <h2>Guest List</h2>
    <div class="card">
      <table id="guestsTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Phone</th>
            <th>Email</th>
            <th>Room</th>
            <th>Check In</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

</div>

<!-- Modals -->
<div id="roomModal" class="modal hidden">
  <div class="modal-content">
    <h3>Add/Edit Room</h3>
    <form id="roomForm">
      <input type="hidden" id="roomId">
      <div class="form-group">
        <label>Room Number</label>
        <input type="text" id="roomNumber" required>
      </div>
      <div class="form-group">
        <label>Type</label>
        <select id="roomType" required>
          <option value="Single">Single</option>
          <option value="Double">Double</option>
          <option value="Suite">Suite</option>
          <option value="Deluxe">Deluxe</option>
        </select>
      </div>
      <div class="form-group">
        <label>Price per Night ($)</label>
        <input type="number" id="roomPrice" required>
      </div>
      <div style="display:flex; gap:1rem;">
        <button type="submit" class="btn btn-primary">Save Room</button>
        <button type="button" class="btn btn-danger" onclick="closeModal('roomModal')">Cancel</button>
      </div>
    </form>
  </div>
</div>

<div id="bookingModal" class="modal hidden">
  <div class="modal-content">
    <h3>New Booking</h3>
    <form id="bookingForm">
      <div class="form-group">
        <label>Guest Name</label>
        <input type="text" id="guestName" required>
      </div>
      <div class="form-group">
        <label>Phone</label>
        <input type="text" id="guestPhone" required>
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="guestEmail">
      </div>
      <div class="form-group">
        <label>Room</label>
        <select id="bookingRoom" required></select>
      </div>
      <div class="form-group">
        <label>Check In</label>
        <input type="date" id="checkIn" required>
      </div>
      <div class="form-group">
        <label>Check Out</label>
        <input type="date" id="checkOut" required>
      </div>
      <div style="display:flex; gap:1rem;">
        <button type="submit" class="btn btn-success">Create Booking</button>
        <button type="button" class="btn btn-danger" onclick="closeModal('bookingModal')">Cancel</button>
      </div>
    </form>
  </div>
</div>

<script>
// Local Storage Helpers
const storage = {
  get: (key) => JSON.parse(localStorage.getItem(key)) || [],
  set: (key, value) => localStorage.setItem(key, JSON.stringify(value))
};

// Data
let rooms = storage.get('rooms');
let bookings = storage.get('bookings');
let bookingIdCounter = parseInt(localStorage.getItem('bookingIdCounter')) || 1;

// Navigation
document.querySelectorAll('nav a').forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
    link.classList.add('active');
    document.querySelectorAll('#dashboard, #rooms, #bookings, #guests').forEach(sec => sec.classList.add('hidden'));
    document.getElementById(link.dataset.page).classList.remove('hidden');
    if (link.dataset.page === 'dashboard') updateDashboard();
    if (link.dataset.page === 'rooms') renderRooms();
    if (link.dataset.page === 'bookings') renderBookings();
    if (link.dataset.page === 'guests') renderGuests();
  });
});

// Modal Functions
function openModal(id) {
  document.getElementById(id).classList.remove('hidden');
}
function closeModal(id) {
  document.getElementById(id).classList.add('hidden');
  document.querySelectorAll('form').forEach(f => f.reset());
  document.getElementById('roomId').value = '';
}

// Room Management
function renderRooms() {
  const tbody = document.querySelector('#roomsTable tbody');
  tbody.innerHTML = '';
  rooms.forEach(room => {
    const tr = document.createElement('tr');
    const isOccupied = bookings.some(b => b.room === room.number && b.status === 'Checked In');
    const status = isOccupied ? 'Occupied' : 'Available';
    tr.innerHTML = `
      <td>${room.number}</td>
      <td>${room.type}</td>
      <td>$${room.price}</td>
      <td><span class="status status-${status.toLowerCase().replace(' ','-')}">${status}</span></td>
      <td>
        <button class="btn btn-warning btn-sm" onclick="editRoom('${room.number}')">Edit</button>
        <button class="btn btn-danger btn-sm" onclick="deleteRoom('${room.number}')">Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
  updateDashboard();
}

function editRoom(number) {
  const room = rooms.find(r => r.number === number);
  document.getElementById('roomId').value = number;
  document.getElementById('roomNumber').value = room.number;
  document.getElementById('roomType').value = room.type;
  document.getElementById('roomPrice').value = room.price;
  openModal('roomModal');
}

function deleteRoom(number) {
  if (confirm('Delete room ' + number + '?')) {
    rooms = rooms.filter(r => r.number !== number);
    storage.set('rooms', rooms);
    renderRooms();
  }
}

document.getElementById('roomForm').addEventListener('submit', (e) => {
  e.preventDefault();
  const id = document.getElementById('roomId').value;
  const room = {
    number: document.getElementById('roomNumber').value,
    type: document.getElementById('roomType').value,
    price: document.getElementById('roomPrice').value
  };
  if (id) {
    rooms = rooms.map(r => r.number === id ? room : r);
  } else {
    rooms.push(room);
  }
  storage.set('rooms', rooms);
  closeModal('roomModal');
  renderRooms();
});

// Booking Management
function populateRoomSelect() {
  const select = document.getElementById('bookingRoom');
  select.innerHTML = '<option value="">Select Room</option>';
  const availableRooms = rooms.filter(room => {
    return !bookings.some(b => b.room === room.number && b.status === 'Checked In');
  });
  availableRooms.forEach(room => {
    const opt = document.createElement('option');
    opt.value = room.number;
    opt.textContent = `${room.number} (${room.type} - $${room.price}/night)`;
    select.appendChild(opt);
  });
}

document.getElementById('bookingModal').addEventListener('click', (e) => {
  if (e.target.classList.contains('modal')) closeModal('bookingModal');
});

document.getElementById('bookingForm').addEventListener('submit', (e) => {
  e.preventDefault();
  const booking = {
    id: bookingIdCounter++,
    guestName: document.getElementById('guestName').value,
    guestPhone: document.getElementById('guestPhone').value,
    guestEmail: document.getElementById('guestEmail').value,
    room: document.getElementById('bookingRoom').value,
    checkIn: document.getElementById('checkIn').value,
    checkOut: document.getElementById('checkOut').value,
    status: 'Confirmed'
  };
  bookings.push(booking);
  storage.set('bookings', bookings);
  localStorage.setItem('bookingIdCounter', bookingIdCounter);
  closeModal('bookingModal');
  renderBookings();
  renderGuests();
});

function renderBookings() {
  const tbody = document.querySelector('#bookingsTable tbody');
  tbody.innerHTML = '';
  const today = new Date().toISOString().split('T')[0];
  bookings.forEach(booking => {
    const isCheckedIn = new Date(booking.checkIn) <= new Date(today) && booking.status !== 'Checked Out';
    if (isCheckedIn && booking.status === 'Confirmed') booking.status = 'Checked In';
    
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>#${booking.id}</td>
      <td>${booking.guestName}</td>
      <td>${booking.room}</td>
      <td>${booking.checkIn}</td>
      <td>${booking.checkOut}</td>
      <td><span class="status status-${booking.status.toLowerCase().replace(' ','-')}">${booking.status}</span></td>
      <td>
        ${booking.status === 'Checked In' ? 
          `<button class="btn btn-success btn-sm" onclick="checkout(${booking.id})">Check Out</button>` : 
          booking.status === 'Confirmed' ? `<button class="btn btn-primary btn-sm" onclick="checkin(${booking.id})">Check In</button>` : ''
        }
      </td>
    `;
    tbody.appendChild(tr);
  });
  updateDashboard();
}

function checkin(id) {
  bookings = bookings.map(b => b.id === id ? {...b, status: 'Checked In'} : b);
  storage.set('bookings', bookings);
  renderBookings();
}

function checkout(id) {
  if (confirm('Check out this guest?')) {
    bookings = bookings.map(b => b.id === id ? {...b, status: 'Checked Out'} : b);
    storage.set('bookings', bookings);
    renderBookings();
  }
}

function filterBookings() {
  const term = document.getElementById('searchBooking').value.toLowerCase();
  const rows = document.querySelectorAll('#bookingsTable tbody tr');
  rows.forEach(row => {
    const text = row.textContent.toLowerCase();
    row.style.display = text.includes(term) ? '' : 'none';
  });
}

// Guests
function renderGuests() {
  const tbody = document.querySelector('#guestsTable tbody');
  tbody.innerHTML = '';
  const currentGuests = bookings.filter(b => b.status === 'Checked In');
  currentGuests.forEach(b => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${b.guestName}</td>
      <td>${b.guestPhone}</td>
      <td>${b.guestEmail || '-'}</td>
      <td>${b.room}</td>
      <td>${b.checkIn}</td>
    `;
    tbody.appendChild(tr);
  });
}

// Dashboard Update
function updateDashboard() {
  const total = rooms.length;
  const occupied = bookings.filter(b => b.status === 'Checked In').length;
  const available = total - occupied;
  const today = new Date().toISOString().split('T')[0];
  const todayBookings = bookings.filter(b => b.checkIn === today).length;

  document.getElementById('totalRooms').textContent = total;
  document.getElementById('availableRooms').textContent = available;
  document.getElementBy-Id('occupiedRooms').textContent = occupied;
  document.getElementById('todayBookings').textContent = todayBookings;
}

// Open booking modal -> populate rooms
document.querySelector('[onclick="openModal(\'bookingModal\')"]').addEventListener('click', populateRoomSelect);

// Initial load
updateDashboard();
renderRooms();
renderBookings();
renderGuests();

</script>
</body>
</html>